<table class="cve-table">
  <thead>
    <tr>
      <th style="width: 10em;">ID</th>
      <th style="width: 10em;">Priority</th>
      <th style="width: 10em;">Package</th>
      {% for release in releases %}
        <th style="width: 10em;">
          <div class="icon-container__text">
            {{ release.version }} {{ release.support_tag }}
          </div>
        </th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for cve in cves %}
      {% for package in cve.packages %}
        <tr>
          {% if loop.index == 1 %}
            <td class="cve-table-cell-id" rowspan="{{ cve.packages | length }}">
              <a href="/security/{{ cve.id }}">{{ cve.id }}</a>
            </td>
            <td class="cve-table-cell-priority" rowspan="{{ cve.packages | length }}">
              <div class="icon-container__icon">
                {% if cve.priority == 'unknown' %}
                  <i class="p-icon--placeholder"></i>
                {% elif cve.priority == 'negligible' %}
                  <i class="p-icon--negligible-priority"></i>
                {% elif cve.priority == 'low' %}
                  <i class="p-icon--low-priority"></i>
                {% elif cve.priority == 'medium' %}
                  <i class="p-icon--medium-priority"></i>
                {% elif cve.priority == 'high' %}
                  <i class="p-icon--high-priority"></i>
                {% elif cve.priority == 'critical' %}
                  <i class="p-icon--critical-priority"></i>
                {% else %}
                  <i class="p-icon--placeholder"></i>
                {% endif %}
              </div>
              <div class="icon-container__text">
                <span class="capitalize">{{ cve.priority }}</span>
              </div>
              <div class="icon-container__icon icon-cve-info">
                <i class="p-icon--information cve-tooltip-icon cve-tooltip-icon-priority" data-priority="{{ cve.priority }}"></i>
              </div>
            </td>
          {% endif %}
          <td>{{ package.name }}</td>
          {% for release in releases %}
            {% for status in package.statuses%}
              {% if release.codename == status.release_codename %}
                {% if loop.index <= releases|length %}
                  <td class="cve-table-cell status-{{ status.status }}">
                  {% if status.status == "DNE" %}
                    <div class="cve-color-strip--dne"></div>
                  {% elif status.status == "needs-triage" %}
                    <div class="cve-color-strip--needs-triage"></div>
                  {% elif status.status == "not-affected" %}
                    <div class="cve-color-strip--not-affected"></div>
                  {% elif status.status == "needed" %}
                    <div class="cve-color-strip--needed"></div>
                  {% elif status.status == "deferred" %}
                    <div class="cve-color-strip--deferred"></div>
                  {% elif status.status == "ignored" %}
                    <div class="cve-color-strip--ignored"></div>
                  {% elif status.status == "pending" %}
                    <div class="cve-color-strip--pending"></div>
                  {% elif status.status == "released" %}
                    <div class="cve-color-strip--released"></div>
                  {% endif %}
                  <div class="icon-container__text">
                    {% if status.status == "DNE" %}
                      Does not exist
                    {% elif status.status == "needs-triage" %}
                      Needs triage 
                    {% elif status.status == "not-affected" %}
                      Not vulnerable
                    {% elif status.status == "needed" %}
                      Needed
                    {% elif status.status == "deferred" %}
                      Deferred
                    {% elif status.status == "ignored" %}
                      Ignored
                    {% elif status.status == "pending" %}
                      Pending
                    {% elif status.status == "released" %}
                      Released
                    {% else %}
                      &mdash;
                    {% endif %}
                    {% if status.pocket != "esm-infra" and status.pocket == "esm-apps" %}
                      <small class="cve-table-cell esm-info">
                        {% if status.pocket == "esm-infra" %}
                          <a href="/advantage">UA Infra/Apps</a>
                        {% endif %}
                        {% if status.pocket == "esm-apps" %}
                          <a href="/advantage">UA Apps</a>
                        {% endif %}
                      </small>
                    {% endif %}
                  </div>
                  <div class="icon-container__icon icon-cve-info">
                    {% if status.status == 'pending' or status.status == "not-affected" %}
                      <i class="p-icon--information cve-tooltip-icon cve-tooltip-status" data-status="{{ status.status }}"></i>
                    {% endif %}
                  </div>
                </td>
                {% else %}
                  <td class="cve-table-cell--muted">
                    <div class="cve-color-strip--dne"></div>
                    &mdash;
                  </td>
                {% endif %}
              {% endif %}
            {% endfor %}
          {% endfor %}
        </tr>
      {% endfor %}
    {% endfor %}
  </tbody>
</table>
